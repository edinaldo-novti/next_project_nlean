# Coolify: defina domínio (ex.: novti.net) e variáveis na UI do app.
# Rede "coolify" deve existir no host (criada pelo Coolify).
#
# Labels: normalmente NÃO são necessárias — defina o domínio na UI (ex.: https://novti.net:3000).
# Use as labels abaixo só se estiver em "Raw Compose Deployment" ou se o proxy não rotear pela UI.

services:
  portal:
    build: .
    restart: unless-stopped
    ports:
      - 3000:3000
    expose:
      - 3000
    environment:
      NODE_ENV: ${NODE_ENV:-production}
      NEXT_PUBLIC_APP_URL: ${NEXT_PUBLIC_APP_URL:-https://novti.net}
    networks:
      coolify:
        aliases:
          - portal
    # Descomente se precisar que o Traefik do Coolify rote por labels (Raw Compose ou UI sem efeito):
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.portal.rule=Host(`novti.net`) || HostRegexp(`{subdomain:.+}.novti.net`)"
      - "traefik.http.routers.portal.entrypoints=web"
      - "traefik.http.services.portal.loadbalancer.server.port=3000"

networks:
  coolify:
    name: coolify
    external: true
